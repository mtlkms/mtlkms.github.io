(function(){"use strict";var t={8743:function(t,a,e){var s=e(9242),i=e(3396),n=e(7139);const o={id:"sidebar"},l={id:"navbar"};function r(t,a,e,r,h,d){const c=(0,i.up)("AppMenu"),u=(0,i.up)("router-view"),g=(0,i.up)("LoadingEffect");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",{onClick:a[0]||(a[0]=t=>d.toggleMenu()),id:"sidebar-bg"},null,512),[[s.F8,h.isMenuOpen]])])),_:1}),(0,i.Wm)(s.uT,{name:"fade-in-left"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",o,[(0,i.Wm)(c)],512),[[s.F8,h.isMenuOpen]])])),_:1}),(0,i._)("div",{id:"main",class:(0,n.C_)({noMarginLeft:!h.isMenuOpen})},[(0,i._)("div",l,[(0,i._)("span",{onClick:a[1]||(a[1]=t=>d.toggleMenu()),class:"material-icons"},"menu"),(0,i.Uk)(" "+(0,n.zw)(t.$route.meta.title),1)]),(0,i.Wm)(u,null,{default:(0,i.w5)((({Component:t})=>[(0,i.Wm)(s.uT,{name:"fade-in-fast",mode:"out-in"},{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.j4)((0,i.LL)(t)))])),_:2},1024)])),_:1})],2),(0,i.Wm)(g)],64)}const h=t=>((0,i.dD)("data-v-4056f21a"),t=t(),(0,i.Cn)(),t),d={id:"appmenu-top"},c={key:0},u=h((()=>(0,i._)("img",{src:"/img/icons/180.png",class:"avatar d-block mx-auto"},null,-1))),g=h((()=>(0,i._)("h3",null,"MTLKMS",-1))),p=h((()=>(0,i._)("hr",null,null,-1))),m=h((()=>(0,i._)("p",null,"Học hành chăm chỉ :(",-1))),_=[u,g,p,m],w={key:1},y=["src"],v=h((()=>(0,i._)("hr",null,null,-1))),D={key:0},f=(0,i.Uk)(" Bạn đang học "),T=(0,i.Uk)(" môn này nè "),k={key:1},b=h((()=>(0,i._)("hr",null,null,-1))),L=h((()=>(0,i._)("p",null,"Bạn còn 99 mục tiêu hằng ngày chưa hoàn tất!",-1))),M={class:"material-icons"};function C(t,a,e,s,o,l){const r=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("div",d,[o.data.isLogin?((0,i.wg)(),(0,i.iD)("div",w,[(0,i._)("img",{src:o.data.avatarURL,class:"avatar d-block mx-auto"},null,8,y),(0,i._)("h3",null,"Xin chào "+(0,n.zw)(o.data.user.name)+"!",1),v,(0,i._)("p",null,[o.data.learningDiary?((0,i.wg)(),(0,i.iD)("span",D,[f,(0,i.Wm)(r,{to:"/study-diary/"+o.data.learningDiary.sdtag},{default:(0,i.w5)((()=>[T])),_:1},8,["to"])])):((0,i.wg)(),(0,i.iD)("span",k," Bạn hiện chưa học gì! "))]),b,L])):((0,i.wg)(),(0,i.iD)("div",c,_))]),(0,i._)("div",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.links,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:a},[o.data.isLogin==t.auth?((0,i.wg)(),(0,i.j4)(r,{key:0,to:t.path,class:(0,n.C_)({active:l.isActive(t),link:!0})},{default:(0,i.w5)((()=>[(0,i._)("span",M,(0,n.zw)(t.icon),1),(0,i.Uk)(" "+(0,n.zw)(t.name),1)])),_:2},1032,["to","class"])):(0,i.kq)("",!0)])))),128))])])}let S={isLogin:!1,isLoading:!1,user:{id:"",name:"",email:"",username:"",slogan:"",created_at:""},learningDiary:!1};class U{constructor(){}get(t){return S[t]}set(t,a){S[t]=a}remove(t){delete S[t]}clear(){S={}}getAll(){return S}}var x=new U,P={name:"AppMenu",data(){return{data:x.getAll(),links:[{name:"Trang Chủ",path:"/",icon:"home",auth:!0},{name:"Cá Nhân",path:"/profile",icon:"person",auth:!0},{name:"Nhật Ký Thời Gian Học",path:"/study-diary",icon:"assignment",auth:!0},{name:"Đăng Nhập",path:"/login",icon:"login",auth:!1},{name:"Đăng Ký",path:"/register",icon:"person",auth:!1},{name:"Đăng Xuất",path:"/logout",icon:"logout",auth:!0}]}},methods:{isActive(t){return t.path==this.$route.path}}},z=e(89);const j=(0,z.Z)(P,[["render",C],["__scopeId","data-v-4056f21a"]]);var A=j;const V=t=>((0,i.dD)("data-v-495a71ea"),t=t(),(0,i.Cn)(),t),F={class:"main"},K=V((()=>(0,i._)("div",{class:"static-bar"},null,-1))),N=V((()=>(0,i._)("div",{class:"move-bar"},null,-1))),O=[K,N];function $(t,a,e,n,o,l){return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",F,O,512),[[s.F8,o.data.isLoading]])])),_:1})])}var E={name:"LoadingEffect",data(){return{data:x.getAll()}}};const W=(0,z.Z)(E,[["render",$],["__scopeId","data-v-495a71ea"]]);var I=W,H={name:"App",components:{AppMenu:A,LoadingEffect:I},created(){this.data.isLogin||"/login"===location.pathname||"/register"===location.pathname||(x.set("redirect",location.pathname),this.$router.push("/login")),innerWidth>768&&(this.isMenuOpen=!0),window.addEventListener("resize",(()=>{innerWidth>768?this.isMenuOpen=!0:this.isMenuOpen=!1})),sessionStorage.clear()},data(){return{isMenuOpen:!1,data:x.getAll()}},watch:{$route:{immediate:!0,handler(t){document.title=t.meta.title||"MTLKMS",innerWidth<768&&(this.isMenuOpen=!1)}}},methods:{toggleMenu(){this.isMenuOpen=!this.isMenuOpen}}};const B=(0,z.Z)(H,[["render",r]]);var R=B,q=e(5431);(0,q.z)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}});var Z=e(678);const Y={class:"container container-md"},X=(0,i._)("h3",null,"Home Page",-1),G=[X];function J(t,a,e,s,n,o){return(0,i.wg)(),(0,i.iD)("div",Y,G)}var Q={name:"HomeView"};const tt=(0,z.Z)(Q,[["render",J]]);var at=tt;const et=t=>((0,i.dD)("data-v-09e31b13"),t=t(),(0,i.Cn)(),t),st={class:"container container-sm"},it=et((()=>(0,i._)("h2",{class:"mb-4"},"Đăng nhập",-1))),nt={class:"input"},ot=et((()=>(0,i._)("span",{class:"material-icons"},"person",-1))),lt=et((()=>(0,i._)("p",null,"Username",-1))),rt={class:"input"},ht=et((()=>(0,i._)("span",{class:"material-icons"},"lock",-1))),dt=et((()=>(0,i._)("p",null,"Password",-1))),ct={class:"footer"},ut=et((()=>(0,i._)("button",{class:"btn btn-primary"},[(0,i._)("span",{class:"material-icons mr-2"},"login"),(0,i.Uk)(" Đăng nhập ")],-1))),gt=(0,i.Uk)("Chưa có tài khoản? "),pt=(0,i.Uk)("[Đăng Ký]"),mt=(0,i.Uk)("[Quên Mật Khẩu]");function _t(t,a,e,o,l,r){const h=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",st,[(0,i._)("form",{action:"",method:"POST",onSubmit:a[2]||(a[2]=(0,s.iM)((t=>r.submitForm()),["prevent"]))},[it,(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",{class:(0,n.C_)(["log",l.isSuccess?"success":"error"])},[(0,i._)("p",null,(0,n.zw)(l.apiLog),1),(0,i._)("p",null,(0,n.zw)(l.log),1)],2),[[s.F8,l.log]])])),_:1}),(0,i._)("label",nt,[ot,(0,i.wy)((0,i._)("input",{type:"text",name:"username",required:"",placeholder:"Username","onUpdate:modelValue":a[0]||(a[0]=t=>l.form.username=t)},null,512),[[s.nr,l.form.username]]),lt]),(0,i._)("label",rt,[ht,(0,i.wy)((0,i._)("input",{type:"password",name:"password",required:"",placeholder:"Mật khẩu","onUpdate:modelValue":a[1]||(a[1]=t=>l.form.password=t)},null,512),[[s.nr,l.form.password]]),dt]),(0,i._)("div",ct,[ut,(0,i._)("div",null,[(0,i._)("p",null,[gt,(0,i.Wm)(h,{to:"/register"},{default:(0,i.w5)((()=>[pt])),_:1})]),(0,i._)("p",null,[(0,i.Wm)(h,{to:""},{default:(0,i.w5)((()=>[mt])),_:1})])])])],32)])}e(1703);class wt{constructor(){this.host="https://cuikho.cf"}get(t){return fetch(this.host+t,{method:"GET",credentials:"include"})}setAvatarURL(){let t=x.get("user").username,a=this.getAvatarURL(t);x.set("avatarURL",a)}getAvatarURL(t){return this.host+"/user/"+t+"/avatar"}post(t,a){return fetch(this.host+t,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}put(t,a){return fetch(this.host+t,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}delete(t,a){return fetch(this.host+t,{method:"DELETE",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}updateAvatar(t){let a=x.get("user").username;return fetch(`${this.host}/user/${a}/avatar`,{method:"PUT",credentials:"include",body:t})}async getLearningDiary(){let t=await this.get("/study-diary/diary/"+x.get("user").id),a=await t.json();if(200==t.status)return a.data;throw new Error(a.error)}}var yt=new wt,vt={name:"LoginView",created(){this.checkLogin()},data(){return{data:x.getAll(),form:{username:"",password:""},isSuccess:!1,apiLog:"",log:""}},methods:{submitForm(){this.data.isLoading=!0,yt.post("/login",this.form).then((t=>{this.data.isLoading=!1,200===t.status?t.json().then((t=>{this.isSuccess=!0,this.apiLog="",this.log="Đăng ký thành công",x.set("user",t.user),x.set("isLogin",!0),yt.setAvatarURL(),this.$router.push("/")})):t.json().then((t=>{this.isSuccess=!1,this.apiLog=t.error,this.showLog()}))})).catch((t=>{this.data.isLoading=!1,console.log(t)}))},showLog(){"Username not found or password is incorrect"==this.apiLog?this.log="Tên đăng nhập hoặc mật khẩu không chính xác":this.log="Đã có lỗi xảy ra"},redirect(){x.get("redirect")&&"/login"!=x.get("redirect")&&"/register"!=x.get("redirect")?(this.$router.push(x.get("redirect")),x.set("redirect",null)):this.$router.push("/")},async checkLogin(){x.get("isLogin")&&this.redirect(),this.data.isLoading=!0;let t=await yt.get("/check-login"),a=await t.json();if(this.data.isLoading=!1,200!==t.status)throw new Error("Check login failed");x.set("user",a.user),x.set("isLogin",!0),yt.setAvatarURL();try{let t=await yt.getLearningDiary();x.set("learningDiary",t)}catch(e){console.log(e)}this.redirect()}}};const Dt=(0,z.Z)(vt,[["render",_t],["__scopeId","data-v-09e31b13"]]);var ft=Dt;const Tt=t=>((0,i.dD)("data-v-d1532384"),t=t(),(0,i.Cn)(),t),kt={class:"container container-sm"},bt=Tt((()=>(0,i._)("h2",{class:"mb-4"},"Đăng ký",-1))),Lt={class:"input"},Mt=Tt((()=>(0,i._)("span",{class:"material-icons"},"label",-1))),Ct=Tt((()=>(0,i._)("p",null,"Tên hiển thị",-1))),St={class:"input"},Ut=Tt((()=>(0,i._)("span",{class:"material-icons"},"person",-1))),xt=Tt((()=>(0,i._)("p",null,"Tên đăng nhập",-1))),Pt={class:"input"},zt=Tt((()=>(0,i._)("span",{class:"material-icons"},"email",-1))),jt=Tt((()=>(0,i._)("p",null,"Email",-1))),At={class:"input"},Vt=Tt((()=>(0,i._)("span",{class:"material-icons"},"lock",-1))),Ft=Tt((()=>(0,i._)("p",null,"Mật khẩu",-1))),Kt={class:"input"},Nt=Tt((()=>(0,i._)("span",{class:"material-icons"},"lock",-1))),Ot=Tt((()=>(0,i._)("p",null,"Re-password",-1))),$t={class:"footer"},Et=Tt((()=>(0,i._)("button",{class:"btn btn-primary"},[(0,i._)("span",{class:"material-icons mr-2"},"send"),(0,i.Uk)(" Đăng ký ")],-1))),Wt=(0,i.Uk)("Đã có tài khoản? "),It=(0,i.Uk)("[Đăng Nhập]"),Ht=(0,i.Uk)("[Quên Mật Khẩu]");function Bt(t,a,e,o,l,r){const h=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",kt,[(0,i._)("form",{action:"",method:"POST",onSubmit:a[5]||(a[5]=(0,s.iM)((t=>r.submitForm()),["prevent"]))},[bt,(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",{class:(0,n.C_)(["log",l.isSuccess?"success":"error"])},[(0,i._)("p",null,(0,n.zw)(l.apiLog),1),(0,i._)("p",null,(0,n.zw)(l.log),1)],2),[[s.F8,l.log]])])),_:1}),(0,i._)("label",Lt,[Mt,(0,i.wy)((0,i._)("input",{type:"text",name:"name",required:"",placeholder:"Tên hiển thị","onUpdate:modelValue":a[0]||(a[0]=t=>l.form.name=t)},null,512),[[s.nr,l.form.name]]),Ct]),(0,i._)("label",St,[Ut,(0,i.wy)((0,i._)("input",{type:"text",name:"username",required:"",placeholder:"Tên đăng nhập","onUpdate:modelValue":a[1]||(a[1]=t=>l.form.username=t)},null,512),[[s.nr,l.form.username]]),xt]),(0,i._)("label",Pt,[zt,(0,i.wy)((0,i._)("input",{type:"email",name:"email",required:"",placeholder:"Email","onUpdate:modelValue":a[2]||(a[2]=t=>l.form.email=t)},null,512),[[s.nr,l.form.email]]),jt]),(0,i._)("label",At,[Vt,(0,i.wy)((0,i._)("input",{type:"password",name:"password",required:"",placeholder:"Mật khẩu","onUpdate:modelValue":a[3]||(a[3]=t=>l.form.password=t)},null,512),[[s.nr,l.form.password]]),Ft]),(0,i._)("label",Kt,[Nt,(0,i.wy)((0,i._)("input",{type:"password",name:"repassword",required:"",placeholder:"Nhập lại mật khẩu","onUpdate:modelValue":a[4]||(a[4]=t=>l.form.repassword=t)},null,512),[[s.nr,l.form.repassword]]),Ot]),(0,i._)("div",$t,[Et,(0,i._)("div",null,[(0,i._)("p",null,[Wt,(0,i.Wm)(h,{to:"/login"},{default:(0,i.w5)((()=>[It])),_:1})]),(0,i._)("p",null,[(0,i.Wm)(h,{to:""},{default:(0,i.w5)((()=>[Ht])),_:1})])])])],32)])}var Rt={name:"RegisterView",data(){return{data:x.getAll(),form:{name:"",username:"",email:"",password:"",repassword:""},apiLog:"",log:"",isSuccess:!1}},methods:{submitForm(){if(this.form.password!==this.form.repassword)return this.log="Mật khẩu không khớp",void(this.isSuccess=!1);this.data.isLoading=!0,yt.post("/register",this.form).then((t=>{this.data.isLoading=!1,200===t.status?t.json().then((t=>{this.isSuccess=!0,this.apiLog="",this.log="Đăng ký thành công",x.set("user",t.user),x.set("isLogin",!0),yt.setAvatarURL(),this.$router.push("/")})):t.json().then((t=>{this.isSuccess=!1,this.apiLog=t.error,this.showLog()}))})).catch((t=>{this.data.isLoading=!1,console.log(t)}))},showLog(){"Invalid name"==this.apiLog?this.log="Tên phải lớn hơn 2 và nhỏ hơn 50 kí tự":"Invalid email"==this.apiLog?this.log="Email không đúng định dạng":"Invalid username"==this.apiLog?this.log="Tên đăng nhập phải từ 3 đến 20 kí tự, không bao gồm khoảng trống và kí tự đặc biệt":"Invalid password"==this.apiLog?this.log="Mật khẩu phải lớn hơn 6 kí tự, bao gồm chữ cái viết thường, viết hoa, số và kí tự đặc biệt":/(ER_DUP_ENTRY: Duplicate entry ').+(' for key 'username')/gi.test(this.apiLog)?this.log="Tên đăng nhập đã tồn tại":/(ER_DUP_ENTRY: Duplicate entry ').+(' for key 'email')/gi.test(this.apiLog)?this.log="Email đã tồn tại":this.log="Đã có lỗi xảy ra"}}};const qt=(0,z.Z)(Rt,[["render",Bt],["__scopeId","data-v-d1532384"]]);var Zt=qt;const Yt={class:"container container-sm"},Xt=(0,i._)("h2",{class:"mb-4"},"Đăng xuất",-1),Gt=(0,i._)("p",null,"Bạn có chắc muốn đăng xuất không?",-1),Jt=(0,i._)("span",{class:"material-icons mr-2"},"logout",-1),Qt=(0,i.Uk)(" Đăng xuất "),ta=[Jt,Qt];function aa(t,a,e,s,n,o){return(0,i.wg)(),(0,i.iD)("div",Yt,[Xt,Gt,(0,i._)("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=(...t)=>o.logout&&o.logout(...t))},ta)])}var ea={name:"LogoutView",data(){return{data:x.getAll()}},methods:{logout(){this.data.isLoading=!0,yt.get("/logout").then((()=>{this.data.isLoading=!1,x.set("isLogin",!1),x.set("user",{}),this.$router.push("/login")})).catch((()=>{this.data.isLoading=!1}))}}};const sa=(0,z.Z)(ea,[["render",aa]]);var ia=sa;const na={class:"container container-md"},oa=(0,i._)("hr",null,null,-1);function la(t,a,e,s,n,o){const l=(0,i.up)("Profile");return(0,i.wg)(),(0,i.iD)("div",na,[(0,i.Wm)(l),oa])}const ra={class:"main"},ha=["src","alt"],da={class:"text-secondary"},ca=(0,i.Uk)("[Edit Profile]");function ua(t,a,e,s,o,l){const r=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",ra,[(0,i._)("img",{src:o.data.avatarURL,alt:o.data.user.username,class:"avatar-xl"},null,8,ha),(0,i._)("div",null,[(0,i._)("h3",null,(0,n.zw)(o.data.user.name),1),(0,i._)("p",da,(0,n.zw)(o.data.user.username)+" - Tham gia lúc "+(0,n.zw)(l.convertTimestampToLocalDate(o.data.user.created_at)),1),(0,i._)("p",null,(0,n.zw)(o.data.user.slogan),1),(0,i._)("p",null,[(0,i.Wm)(r,{to:"/profile/edit"},{default:(0,i.w5)((()=>[ca])),_:1})])])])}var ga={name:"UserProfile",data(){return{data:x.getAll(),api:yt}},methods:{convertTimestampToLocalDate(t){return new Date(t).toLocaleString("vi-VN",{timeZone:"Asia/Ho_Chi_Minh"})}}};const pa=(0,z.Z)(ga,[["render",ua],["__scopeId","data-v-66e9c496"]]);var ma=pa,_a={name:"ProfileView",components:{Profile:ma},data(){return{data:x.getAll()}},methods:{}};const wa=(0,z.Z)(_a,[["render",la]]);var ya=wa;const va={class:"container container-sm"},Da={class:"breadcrumb"},fa=(0,i.Uk)("Cá Nhân"),Ta=(0,i.Uk)("Sửa Thông Tin Cá Nhân"),ka=["src","alt"],ba=(0,i._)("br",null,null,-1),La=(0,i._)("p",null,"Cập nhật ảnh đại diện",-1),Ma={class:"input"},Ca=(0,i._)("button",{class:"btn btn-primary"},[(0,i._)("span",{class:"material-icons mr-2"},"file_upload"),(0,i.Uk)(" Upload ")],-1),Sa=(0,i._)("hr",null,null,-1),Ua=(0,i._)("p",null,"Cập nhật thông tin cá nhân",-1),xa={class:"input"},Pa=(0,i._)("span",{class:"material-icons"},"label",-1),za=(0,i._)("p",null,"Tên hiển thị",-1),ja={class:"input"},Aa=(0,i._)("span",{class:"material-icons"},"favorite",-1),Va=(0,i._)("p",null,"Châm ngôn",-1),Fa=(0,i._)("button",{class:"btn btn-primary"},[(0,i._)("span",{class:"material-icons mr-2"},"save"),(0,i.Uk)(" Save ")],-1),Ka=(0,i._)("hr",null,null,-1),Na=(0,i._)("p",null,"Cập nhật mật khẩu",-1),Oa={class:"input"},$a=(0,i._)("span",{class:"material-icons"},"lock",-1),Ea=(0,i._)("p",null,"Mật khẩu cũ",-1),Wa={class:"input"},Ia=(0,i._)("span",{class:"material-icons"},"lock",-1),Ha=(0,i._)("p",null,"Mật khẩu mới",-1),Ba={class:"input"},Ra=(0,i._)("span",{class:"material-icons"},"lock",-1),qa=(0,i._)("p",null,"Xác nhận mật khẩu",-1),Za=(0,i._)("button",{class:"btn btn-primary"},[(0,i._)("span",{class:"material-icons mr-2"},"save"),(0,i.Uk)(" Save ")],-1);function Ya(t,a,e,n,o,l){const r=(0,i.up)("router-link"),h=(0,i.up)("message-popup");return(0,i.wg)(),(0,i.iD)("div",va,[(0,i._)("div",Da,[(0,i.Wm)(r,{to:"/profile"},{default:(0,i.w5)((()=>[fa])),_:1}),(0,i.Wm)(r,{to:"/profile/edit"},{default:(0,i.w5)((()=>[Ta])),_:1})]),(0,i._)("form",{action:"",onSubmit:a[1]||(a[1]=(0,s.iM)((t=>l.updateAvatar()),["prevent"]))},[(0,i._)("img",{src:o.avatarPreview,alt:o.data.user.username,class:"d-block mx-auto avatar-xl"},null,8,ka),ba,La,(0,i._)("label",Ma,[(0,i._)("input",{type:"file",onChange:a[0]||(a[0]=(...t)=>l.onchangeAvatar&&l.onchangeAvatar(...t))},null,32)]),Ca],32),Sa,(0,i._)("form",{action:"",onSubmit:a[4]||(a[4]=(0,s.iM)((t=>l.updateProfile()),["prevent"]))},[Ua,(0,i._)("label",xa,[Pa,(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=t=>o.form.name=t),placeholder:"Tên hiển thị"},null,512),[[s.nr,o.form.name]]),za]),(0,i._)("label",ja,[Aa,(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=t=>o.form.slogan=t),placeholder:"Châm ngôn"},null,512),[[s.nr,o.form.slogan]]),Va]),Fa],32),Ka,(0,i._)("form",{action:"",onSubmit:a[8]||(a[8]=(0,s.iM)((t=>l.updatePassword()),["prevent"]))},[Na,(0,i._)("label",Oa,[$a,(0,i.wy)((0,i._)("input",{type:"password","onUpdate:modelValue":a[5]||(a[5]=t=>o.passwordForm.oldPassword=t),placeholder:"Mật khẩu cũ"},null,512),[[s.nr,o.passwordForm.oldPassword]]),Ea]),(0,i._)("label",Wa,[Ia,(0,i.wy)((0,i._)("input",{type:"password","onUpdate:modelValue":a[6]||(a[6]=t=>o.passwordForm.newPassword=t),placeholder:"Mật khẩu mới"},null,512),[[s.nr,o.passwordForm.newPassword]]),Ha]),(0,i._)("label",Ba,[Ra,(0,i.wy)((0,i._)("input",{type:"password","onUpdate:modelValue":a[7]||(a[7]=t=>o.rePassword=t),placeholder:"Xác nhận mật khẩu"},null,512),[[s.nr,o.rePassword]]),qa]),Za],32),(0,i.Wm)(h,{title:o.message.title,message:o.message.message,type:o.message.type,"is-display":o.message.isDisplay},null,8,["title","message","type","is-display"])])}const Xa={class:"popup"},Ga={class:"container container-sm"},Ja={class:"d-flex justify-content-center align-items-center"},Qa={class:"material-icons mr-2"};function te(t,a,e,o,l,r){return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Xa,[(0,i._)("div",{class:"popup-bg",onClick:a[0]||(a[0]=t=>r.close())}),(0,i._)("div",Ga,[(0,i._)("div",{class:(0,n.C_)(e.type)},[(0,i._)("div",Ja,[(0,i._)("span",Qa,(0,n.zw)(r.icon),1),(0,i._)("h3",null,(0,n.zw)(e.title),1)]),(0,i._)("span",{class:"material-icons btn-close",onClick:a[1]||(a[1]=t=>r.close())},"close")],2),(0,i._)("div",null,[(0,i._)("p",null,(0,n.zw)(e.message),1)])])],512),[[s.F8,l.display]])])),_:1})])}var ae={name:"MessagePopup",props:{title:{type:String,default:""},message:{type:String,default:""},type:{type:String,default:"success"},isDisplay:{type:Boolean,default:!1}},data(){return{display:!1}},methods:{close(){this.display=!1}},watch:{isDisplay(){this.display=!0}},computed:{icon(){switch(this.type){case"success":return"check_circle";case"error":return"error";case"warning":return"warning";default:return"check_circle"}}}};const ee=(0,z.Z)(ae,[["render",te]]);var se=ee,ie={name:"EditProfileView",components:{MessagePopup:se},data(){return{data:x.getAll(),form:{name:x.get("user").name,slogan:x.get("user").slogan},passwordForm:{oldPassword:"",newPassword:""},rePassword:"",avatarPreview:yt.getAvatarURL(x.get("user").username),avatarFile:null,isLoading:!1,message:{title:"",message:"",type:"",isDisplay:!1}}},methods:{updateAvatar(){if(!this.avatarFile)return void this.showMessage("Lỗi","Vui lòng chọn ảnh đại diện","error");let t=new FormData;t.append("avatar",this.avatarFile),this.data.isLoading=!0,yt.updateAvatar(t).then((t=>{this.data.isLoading=!1,200==t.status?location.reload():this.showMessage("Lỗi!","Có lỗi xảy ra, vui lòng thử lại","error")})).catch((t=>{this.data.isLoading=!1,console.log(t),this.showMessage("Lỗi!","Không thể kết nối đến máy chủ","error")}))},updateProfile(){this.form.name&&this.form.slogan?(this.data.isLoading=!0,yt.put("/user",this.form).then((t=>{this.data.isLoading=!1,200==t.status?t.json().then((t=>{this.data.user=t.user,this.showMessage("Thành công","Cập nhật thông tin cá nhân thành công","success")})):t.json().then((t=>{console.log(t.error);let a="";a="Invalid name"==t.error?"Tên hiển thị phải lớn hơn 2 và nhỏ hơn 50 kí tự":"Có lỗi xảy ra, vui lòng thử lại",this.showMessage("Lỗi!",a,"error")}))})).catch((t=>{this.data.isLoading=!1,console.log(t),this.showMessage("Lỗi!","Không thể kết nối đến máy chủ","error")}))):this.showMessage("Lỗi","Vui lòng nhập đầy đủ thông tin","warning")},updatePassword(){this.passwordForm.oldPassword&&this.passwordForm.newPassword?this.passwordForm.newPassword==this.rePassword?(this.data.isLoading=!0,yt.put("/user/password",this.passwordForm).then((t=>{this.data.isLoading=!1,200==t.status?(t.json().then((()=>{this.showMessage("Thành công","Cập nhật mật khẩu thành công","success")})),this.$router.push("/profile")):t.json().then((t=>{console.log(t.error);let a="";a="Invalid password"==t.error?"Mật khẩu phải từ 6 kí tự, bao gồm chữ in hoa, chữ in thường, số và kí tự đặc biệt":"Old password is incorrect"==t.error?"Mật khẩu cũ không chính xác":"Có lỗi xảy ra, vui lòng thử lại",this.showMessage("Lỗi!",a,"error")}))})).catch((t=>{this.data.isLoading=!1,console.log(t),this.showMessage("Lỗi!","Không thể kết nối đến máy chủ","error")}))):this.showMessage("Lỗi","Mật khẩu mới và xác nhận mật khẩu không khớp","warning"):this.showMessage("Lỗi","Vui lòng nhập đầy đủ thông tin","warning")},onchangeAvatar(t){let a=t.target.files||t.dataTransfer.files;a.length&&this.convertAvatar(a[0])},convertAvatar(t){let a=document.createElement("canvas"),e=a.getContext("2d"),s=document.createElement("img"),i=256;a.width=i,a.height=i,s.src=URL.createObjectURL(t),s.onload=()=>{if(URL.revokeObjectURL(s.src),s.width>s.height){let t=s.height/i,a=s.width/t;e.drawImage(s,0,0,a,i)}else{let t=s.width/i,a=s.height/t;e.drawImage(s,0,0,i,a)}this.avatarPreview=a.toDataURL(),fetch(this.avatarPreview).then((t=>{t.arrayBuffer().then((t=>{this.avatarFile=new File([t],"avatar",{type:"image/png"})}))}))}},showMessage(t,a,e){this.message.title=t,this.message.message=a,this.message.type=e,this.message.isDisplay=!this.message.isDisplay}}};const ne=(0,z.Z)(ie,[["render",Ya]]);var oe=ne;const le=t=>((0,i.dD)("data-v-69cb2b7c"),t=t(),(0,i.Cn)(),t),re={class:"container"},he=le((()=>(0,i._)("h3",null,"Đang học",-1))),de={key:0},ce={key:1,class:"grid-list"},ue={class:"title"},ge={class:"material-icons mr-2"},pe=le((()=>(0,i._)("div",null,[(0,i._)("button",null,[(0,i._)("span",{class:"material-icons"},"edit")]),(0,i._)("button",null,[(0,i._)("span",{class:"material-icons"},"delete_forever")])],-1))),me={class:"body"},_e={class:"d-flex justify-space-between align-items-center"},we=le((()=>(0,i._)("h3",null,"Thẻ Lĩnh Vực",-1))),ye=le((()=>(0,i._)("span",{class:"material-icons mr-2"},"add",-1))),ve=(0,i.Uk)(" Thêm "),De=[ye,ve],fe={key:2},Te={key:3,class:"grid-list"},ke={class:"title"},be={class:"material-icons mr-2"},Le=["onClick"],Me=le((()=>(0,i._)("span",{class:"material-icons"},"edit",-1))),Ce=[Me],Se=["onClick"],Ue=le((()=>(0,i._)("span",{class:"material-icons"},"delete_forever",-1))),xe=[Ue],Pe={class:"body"},ze={class:"popup"},je={class:"container container-sm"},Ae={class:"d-flex justify-content-center align-items-center"},Ve=le((()=>(0,i._)("span",{class:"material-icons mr-2"},"edit",-1))),Fe=le((()=>(0,i._)("p",null,"Preview: ",-1))),Ke={class:"title"},Ne={class:"d-flex align-items-center"},Oe={class:"material-icons mr-2"},$e=le((()=>(0,i._)("button",null,[(0,i._)("span",{class:"material-icons"},"edit")],-1))),Ee={class:"body"},We=le((()=>(0,i._)("br",null,null,-1))),Ie=le((()=>(0,i._)("hr",null,null,-1))),He={class:"mb-3 mt-3"},Be={class:"mr-3"},Re=le((()=>(0,i._)("span",{class:"mr-3"},"Màu nền",-1))),qe=le((()=>(0,i._)("span",{class:"mr-3"},"Màu chữ",-1))),Ze=le((()=>(0,i._)("hr",null,null,-1))),Ye={class:"mt-3 mb-3"},Xe=le((()=>(0,i._)("p",null,"Icon: ",-1))),Ge=["onClick"],Je=le((()=>(0,i._)("hr",null,null,-1))),Qe={class:"mt-3 mb-4"},ts=le((()=>(0,i._)("p",null,"Tên: ",-1))),as={class:"input"},es=le((()=>(0,i._)("span",{class:"material-icons"},"tag",-1))),ss=le((()=>(0,i._)("p",null,"Tên thẻ",-1))),is=le((()=>(0,i._)("button",{class:"btn btn-primary"},[(0,i._)("span",{class:"material-icons mr-2"},"save"),(0,i.Uk)(" Lưu ")],-1))),ns={class:"popup"},os={class:"container container-sm"},ls={class:"d-flex justify-content-center align-items-center"},rs=le((()=>(0,i._)("span",{class:"material-icons mr-2"},"delete_forever",-1))),hs=(0,i.Uk)("Bạn có chắc muốn xóa thẻ "),ds=(0,i.Uk)(" không?"),cs=le((()=>(0,i._)("p",null,"Thẻ này sẽ bị xóa vĩnh viễn.",-1))),us={class:"mt-3 mb-3"},gs=le((()=>(0,i._)("span",{class:"material-icons mr-2"},"delete_forever",-1))),ps=(0,i.Uk)(" Xóa "),ms=[gs,ps];function _s(t,a,e,o,l,r){const h=(0,i.up)("router-link"),d=(0,i.up)("MessagePopup");return(0,i.wg)(),(0,i.iD)("div",re,[he,0==l.learningTags.length?((0,i.wg)(),(0,i.iD)("div",de," Bạn hiện chưa học gì ")):((0,i.wg)(),(0,i.iD)("div",ce,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.learningTags,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:a},[(0,i._)("div",{class:"grid-item",style:(0,n.j5)({backgroundColor:t.bg_color,color:t.text_color})},[(0,i._)("div",ue,[(0,i.Wm)(h,{class:"d-flex align-items-center",to:`/study-diary/${t.id}`,id:`sdtag_${t.id}`},{default:(0,i.w5)((()=>[(0,i._)("span",ge,(0,n.zw)(t.icon),1),(0,i._)("b",null,(0,n.zw)(t.name),1)])),_:2},1032,["to","id"]),pe]),(0,i._)("div",me,[(0,i._)("p",null,"Hôm nay: "+(0,n.zw)(r.showTime(t.time_today)),1),(0,i._)("p",null,"Tuần này: "+(0,n.zw)(r.showTime(t.time_week)),1),(0,i._)("p",null,"Tháng này: "+(0,n.zw)(r.showTime(t.time_month)),1),(0,i._)("p",null,"Năm nay: "+(0,n.zw)(r.showTime(t.time_year)),1),(0,i._)("p",null,"Tổng thời gian học: "+(0,n.zw)(r.showTime(t.time_total)),1)])],4)])))),128))])),(0,i._)("div",_e,[we,(0,i._)("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=(...t)=>r.openCreateTagPopup&&r.openCreateTagPopup(...t))},De)]),0==l.tags.length?((0,i.wg)(),(0,i.iD)("div",fe," Bạn chưa tạo thẻ nào ")):((0,i.wg)(),(0,i.iD)("div",Te,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.tags,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:a},[(0,i._)("div",{class:"grid-item",style:(0,n.j5)({backgroundColor:t.bg_color,color:t.text_color})},[(0,i._)("div",ke,[(0,i.Wm)(h,{class:"d-flex align-items-center",to:`/study-diary/${t.id}`,id:`sdtag_${t.id}`},{default:(0,i.w5)((()=>[(0,i._)("span",be,(0,n.zw)(t.icon),1),(0,i._)("b",null,(0,n.zw)(t.name),1)])),_:2},1032,["to","id"]),(0,i._)("div",null,[(0,i._)("button",{onClick:t=>r.openEditTagPopup(a)},Ce,8,Le),(0,i._)("button",{onClick:t=>r.openDeleteTagPopup(a)},xe,8,Se)])]),(0,i._)("div",Pe,[(0,i._)("p",null,"Hôm nay: "+(0,n.zw)(r.showTime(t.time_today)),1),(0,i._)("p",null,"Tuần này: "+(0,n.zw)(r.showTime(t.time_week)),1),(0,i._)("p",null,"Tháng này: "+(0,n.zw)(r.showTime(t.time_month)),1),(0,i._)("p",null,"Năm nay: "+(0,n.zw)(r.showTime(t.time_year)),1),(0,i._)("p",null,"Tổng: "+(0,n.zw)(r.showTime(t.time_total)),1)])],4)])))),128))])),(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",ze,[(0,i._)("div",{class:"popup-bg",onClick:a[1]||(a[1]=t=>l.editTagData.isDisplay=!1)}),(0,i._)("div",je,[(0,i._)("div",null,[(0,i._)("div",Ae,[Ve,(0,i._)("h3",null,(0,n.zw)(l.editTagData.title),1)]),(0,i._)("span",{class:"material-icons btn-close",onClick:a[2]||(a[2]=t=>l.editTagData.isDisplay=!1)},"close")]),(0,i._)("div",null,[Fe,(0,i._)("div",{class:"grid-item",style:(0,n.j5)({backgroundColor:l.editTagData.bgColor,color:l.editTagData.textColor})},[(0,i._)("div",Ke,[(0,i._)("div",Ne,[(0,i._)("span",Oe,(0,n.zw)(l.editTagData.icon),1),(0,i._)("b",null,(0,n.zw)(l.editTagData.name),1)]),$e]),(0,i._)("div",Ee,[(0,i._)("p",null,"Hôm nay: "+(0,n.zw)(l.editTagData.times.today)+" giờ",1),(0,i._)("p",null,"Tuần này: "+(0,n.zw)(l.editTagData.times.week)+" giờ",1),(0,i._)("p",null,"Tháng này: "+(0,n.zw)(l.editTagData.times.month)+" giờ",1),(0,i._)("p",null,"Năm nay: "+(0,n.zw)(l.editTagData.times.year)+" giờ",1),(0,i._)("p",null,"Tổng: "+(0,n.zw)(l.editTagData.times.total)+" giờ",1)])],4),We,Ie,(0,i._)("form",{action:"",onSubmit:a[6]||(a[6]=(0,s.iM)(((...t)=>r.submitEditTag&&r.submitEditTag(...t)),["prevent"]))},[(0,i._)("div",He,[(0,i._)("span",Be,[Re,(0,i.wy)((0,i._)("input",{type:"color","onUpdate:modelValue":a[3]||(a[3]=t=>l.editTagData.bgColor=t),required:""},null,512),[[s.nr,l.editTagData.bgColor]])]),(0,i._)("span",null,[qe,(0,i.wy)((0,i._)("input",{type:"color","onUpdate:modelValue":a[4]||(a[4]=t=>l.editTagData.textColor=t),required:""},null,512),[[s.nr,l.editTagData.textColor]])])]),Ze,(0,i._)("div",Ye,[Xe,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.icons,((t,a)=>((0,i.wg)(),(0,i.iD)("span",{key:a},[(0,i._)("span",{class:"material-icons btn-icon",onClick:a=>l.editTagData.icon=t},(0,n.zw)(t),9,Ge)])))),128))]),Je,(0,i._)("div",Qe,[ts,(0,i._)("label",as,[es,(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":a[5]||(a[5]=t=>l.editTagData.name=t),placeholder:"Tên thẻ",required:""},null,512),[[s.nr,l.editTagData.name]]),ss])]),is],32)])])],512),[[s.F8,l.editTagData.isDisplay]])])),_:1}),(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",ns,[(0,i._)("div",{class:"popup-bg",onClick:a[7]||(a[7]=t=>l.deleteTagData.isDisplay=!1)}),(0,i._)("div",os,[(0,i._)("div",null,[(0,i._)("div",ls,[rs,(0,i._)("h3",null,(0,n.zw)(l.deleteTagData.title),1)]),(0,i._)("span",{class:"material-icons btn-close",onClick:a[8]||(a[8]=t=>l.deleteTagData.isDisplay=!1)},"close")]),(0,i._)("div",null,[(0,i._)("p",null,[hs,(0,i._)("b",null,(0,n.zw)(l.deleteTagData.name),1),ds]),cs,(0,i._)("div",us,[(0,i._)("button",{class:"btn btn-primary",onClick:a[9]||(a[9]=(...t)=>r.deleteTag&&r.deleteTag(...t))},ms)])])])],512),[[s.F8,l.deleteTagData.isDisplay]])])),_:1}),(0,i.Wm)(d,{title:l.message.title,message:l.message.message,type:l.message.type,"is-display":l.message.isDisplay},null,8,["title","message","type","is-display"])])}var ws={name:"SDListView",components:{MessagePopup:se},created(){this.loadSessionData()||this.getTags()},data(){return{data:x.getAll(),tags:[],learningTags:[],editTagData:{title:"Sửa thẻ",index:0,id:0,icon:"",name:"",textColor:"",bgColor:"",times:{today:0,week:0,month:0,year:0,total:0},isDisplay:!1},deleteTagData:{title:"Xóa thẻ",isDisplay:!1,index:0,id:0,name:""},icons:["school","sports_esports","cake","self_improvement","water","nights_stay","sports_gymnastics","piano","music_note","movie","equalizer","shopping_cart","credit_card","receipt_long","attach_money","sell","work","calculate","edit_notifications","mail","notifications","hub","smartphone","print","computer","desktop_windows","headphones","smart_toy","keyboard","memory","menu_book","star","library_books","auto_stories","local_library","import_contacts","sticky_note_2","note","laptop_chromebook","style","edit","construction","draw","mic","palette","code","terminal","data_object","data_array"],message:{title:"",message:"",type:"",isDisplay:!1}}},methods:{getTags(){this.data.isLoading=!0,yt.get("/study-diary/"+this.data.user.id).then((t=>{this.data.isLoading=!1,200===t.status?t.json().then((t=>{this.data.learningDiary?t.data.forEach((t=>{t.id==this.data.learningDiary.sdtag?this.learningTags.push(t):this.tags.push(t)})):this.tags=t.data,this.saveSessionData()})):t.json().then((t=>{console.log(t.error),this.showMessage("Lỗi","Không thể lấy dữ liệu","error")}))})).catch((t=>{console.log(t),this.data.isLoading=!1,this.showMessage("Lỗi","Lỗi kết nối đến server","error")}))},openCreateTagPopup(){this.editTagData.title="Tạo thẻ",this.editTagData.id=0,this.editTagData.icon="star",this.editTagData.name="New Tag",this.editTagData.textColor="#000000",this.editTagData.bgColor="#ffa799",this.editTagData.times={today:0,week:0,month:0,year:0,total:0},this.editTagData.isDisplay=!0},openEditTagPopup(t){this.editTagData.title="Sửa thẻ "+this.tags[t].id,this.editTagData.index=t,this.editTagData.id=this.tags[t].id,this.editTagData.icon=this.tags[t].icon,this.editTagData.name=this.tags[t].name,this.editTagData.textColor=this.tags[t].text_color,this.editTagData.bgColor=this.tags[t].bg_color,this.editTagData.times.today=this.tags[t].time_today,this.editTagData.times.week=this.tags[t].time_week,this.editTagData.times.month=this.tags[t].time_month,this.editTagData.times.year=this.tags[t].time_year,this.editTagData.times.total=this.tags[t].time_total,this.editTagData.isDisplay=!0},openDeleteTagPopup(t){this.deleteTagData.title="Xóa thẻ "+this.tags[t].id,this.deleteTagData.index=t,this.deleteTagData.id=this.tags[t].id,this.deleteTagData.name=this.tags[t].name,this.deleteTagData.isDisplay=!0},submitEditTag(){0===this.editTagData.id?this.createTag():this.updateTag()},createTag(){this.data.isLoading=!0,yt.post("/study-diary",{name:this.editTagData.name,icon:this.editTagData.icon,bg_color:this.editTagData.bgColor,text_color:this.editTagData.textColor}).then((t=>{this.data.isLoading=!1,200==t.status?t.json().then((t=>{this.tags.push(t.result),this.saveSessionData(),this.showMessage("Thành công","Thêm thẻ thành công","success"),this.editTagData.isDisplay=!1})):t.json().then((t=>{console.log(t.error),this.showMessage("Lỗi","Thêm thẻ thất bại","error")}))})).catch((t=>{this.data.isLoading=!1,this.showMessage("Lỗi","Không thể kết nối đến máy chủ","error"),this.editTagData.isDisplay=!1,console.log(t)}))},updateTag(){this.data.isLoading=!0,yt.put("/study-diary",{id:this.editTagData.id,name:this.editTagData.name,icon:this.editTagData.icon,bg_color:this.editTagData.bgColor,text_color:this.editTagData.textColor}).then((t=>{this.data.isLoading=!1,200==t.status?t.json().then((t=>{this.tags[this.editTagData.index]=t.result,this.saveSessionData(),this.showMessage("Thành công","Cập nhật thẻ thành công","success"),this.editTagData.isDisplay=!1})):t.json().then((t=>{console.log(t.error),this.showMessage("Lỗi","Cập nhật thẻ thất bại","error")}))})).catch((t=>{this.data.isLoading=!1,this.showMessage("Lỗi","Không thể kết nối đến máy chủ","error"),this.editTagData.isDisplay=!1,console.log(t)}))},deleteTag(){this.data.isLoading=!0,yt["delete"]("/study-diary",{id:this.deleteTagData.id}).then((t=>{this.data.isLoading=!1,200==t.status?t.json().then((()=>{this.tags.splice(this.deleteTagData.index,1),this.saveSessionData(),this.showMessage("Thành công","Xóa thẻ thành công","success"),this.deleteTagData.isDisplay=!1})):t.json().then((t=>{console.log(t.error),this.showMessage("Lỗi","Xóa thẻ thất bại","error")}))})).catch((t=>{this.data.isLoading=!1,this.showMessage("Lỗi","Không thể kết nối đến máy chủ","error"),this.deleteTagData.isDisplay=!1,console.log(t)}))},showMessage(t,a,e){this.message.title=t,this.message.message=a,this.message.type=e,this.message.isDisplay=!this.message.isDisplay},showTime(t){let a=(t/60).toFixed(2);return`${a} giờ (${t} phút)`},saveSessionData(){sessionStorage.setItem("tags",JSON.stringify({tags:this.tags,learningTags:this.learningTags}))},loadSessionData(){let t=sessionStorage.getItem("tags");if(t){let a=JSON.parse(t);return this.tags=a.tags,this.learningTags=a.learningTags,!0}return!1}}};const ys=(0,z.Z)(ws,[["render",_s],["__scopeId","data-v-69cb2b7c"]]);var vs=ys;const Ds=t=>((0,i.dD)("data-v-495c6444"),t=t(),(0,i.Cn)(),t),fs={class:"container"},Ts={class:"breadcrumb"},ks=(0,i.Uk)("Nhật Ký T.Gian Học"),bs={key:0},Ls=Ds((()=>(0,i._)("span",{class:"material-icons"},"stop",-1))),Ms=[Ls],Cs=(0,i.Uk)("Bắt đầu: "),Ss=(0,i.Uk)("Đang học "),Us=Ds((()=>(0,i._)("span",{class:"material-icons"},"play_arrow",-1))),xs=[Us],Ps={class:"d-flex justify-content-center align-items-center"},zs={class:"material-icons mr-2"},js=(0,i.Uk)("Hôm nay: "),As=(0,i.Uk)("Tuần này: "),Vs=(0,i.Uk)("Tháng này: "),Fs=(0,i.Uk)("Năm nay: "),Ks=(0,i.Uk)("Tổng thời gian học: "),Ns={class:"popup"},Os={class:"container container-md"},$s=Ds((()=>(0,i._)("div",{class:"d-flex justify-content-center align-items-center"},[(0,i._)("span",{class:"material-icons mr-2"},"delete_forever"),(0,i._)("h3",null,"Không học nữa à?")],-1))),Es=Ds((()=>(0,i._)("p",null,"Bạn đã học được gì rồi? Viết xuống đây nhé!",-1))),Ws={class:"text-secondary"},Is=(0,i.Uk)(" (Cú pháp viết chuẩn "),Hs=(0,i.Uk)("Markdown"),Bs=(0,i.Uk)(") "),Rs=Ds((()=>(0,i._)("p",null,"Preview: ",-1))),qs=["innerHTML"],Zs=Ds((()=>(0,i._)("span",{class:"material-icons"},"save",-1))),Ys=(0,i.Uk)(" Lưu "),Xs=[Zs,Ys],Gs=Ds((()=>(0,i._)("h3",null,"Nhật Ký Học Tập",-1)));function Js(t,a,e,o,l,r){const h=(0,i.up)("router-link"),d=(0,i.up)("TextArea"),c=(0,i.up)("ContributionDiary"),u=(0,i.up)("MessagePopup");return(0,i.wg)(),(0,i.iD)("div",fs,[(0,i._)("div",Ts,[(0,i.Wm)(h,{to:"/study-diary"},{default:(0,i.w5)((()=>[ks])),_:1}),(0,i.Wm)(h,{to:"/study-diary/"+l.tagData.id},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(l.tagData.name),1)])),_:1},8,["to"])]),(0,i._)("div",{class:"header mb-4",style:(0,n.j5)({backgroundColor:l.tagData.bg_color,color:l.tagData.text_color})},[(0,i._)("div",null,[1==l.learningDiaryData.is_learning?((0,i.wg)(),(0,i.iD)("div",bs,[(0,i._)("div",{class:"icon",onClick:a[0]||(a[0]=t=>l.stopLearnPopup.isDisplay=!0)},Ms),(0,i._)("p",null,[Cs,(0,i._)("b",null,(0,n.zw)(r.convertISOTimeToLocalDate(l.learningDiaryData.start_at)),1)]),(0,i._)("p",null,[Ss,(0,i._)("b",null,(0,n.zw)(r.showStopwatchTime),1)])])):((0,i.wg)(),(0,i.iD)("div",{key:1,class:"icon",onClick:a[1]||(a[1]=t=>r.startLearn())},xs))]),(0,i._)("div",null,[(0,i._)("div",Ps,[(0,i._)("span",zs,(0,n.zw)(l.tagData.icon),1),(0,i._)("h3",null,(0,n.zw)(l.tagData.name),1)]),(0,i._)("p",null,[js,(0,i._)("b",null,(0,n.zw)(r.minutesToStr(l.tagData.time_today)),1)]),(0,i._)("p",null,[As,(0,i._)("b",null,(0,n.zw)(r.minutesToStr(l.tagData.time_week)),1)]),(0,i._)("p",null,[Vs,(0,i._)("b",null,(0,n.zw)(r.minutesToStr(l.tagData.time_month)),1)]),(0,i._)("p",null,[Fs,(0,i._)("b",null,(0,n.zw)(r.minutesToStr(l.tagData.time_year)),1)]),(0,i._)("p",null,[Ks,(0,i._)("b",null,(0,n.zw)(r.minutesToStr(l.tagData.time_total)),1)])])],4),(0,i.Wm)(s.uT,{name:"fade-in"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",Ns,[(0,i._)("div",{class:"popup-bg",onClick:a[2]||(a[2]=t=>l.stopLearnPopup.isDisplay=!1)}),(0,i._)("div",Os,[(0,i._)("div",null,[$s,(0,i._)("span",{class:"material-icons btn-close",onClick:a[3]||(a[3]=t=>l.stopLearnPopup.isDisplay=!1)},"close")]),(0,i._)("div",null,[Es,(0,i._)("p",Ws,[Is,(0,i.Wm)(h,{to:"/"},{default:(0,i.w5)((()=>[Hs])),_:1}),Bs]),(0,i.Wm)(d,{modelValue:l.stopLearnPopup.log,"onUpdate:modelValue":a[4]||(a[4]=t=>l.stopLearnPopup.log=t),rows:20,placeholder:"Viết những gì bạn vừa học xuống đây nhé!"},null,8,["modelValue"]),Rs,(0,i._)("div",{class:"quote",innerHTML:l.stopLearnPopup.preview},null,8,qs),(0,i._)("button",{class:"btn btn-primary",onClick:a[5]||(a[5]=t=>r.stopLearn())},Xs)])])],512),[[s.F8,l.stopLearnPopup.isDisplay]])])),_:1}),(0,i._)("div",null,[Gs,0!=l.tagData.id?((0,i.wg)(),(0,i.j4)(c,{key:0,tag:l.tagData.id,"refesh-toogle":l.refeshToggle},null,8,["tag","refesh-toogle"])):(0,i.kq)("",!0)]),(0,i.Wm)(u,{title:l.message.title,message:l.message.message,type:l.message.type,"is-display":l.message.isDisplay},null,8,["title","message","type","is-display"])])}const Qs={class:"header"},ti=["rows","placeholder"];function ai(t,a,e,n,o,l){return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("div",Qs,[(0,i._)("span",{onClick:a[0]||(a[0]=t=>l.insert("**Bold text**")),class:"material-icons btn-icon",title:"In đậm"},"format_bold"),(0,i._)("span",{onClick:a[1]||(a[1]=t=>l.insert("*Italic text*")),class:"material-icons btn-icon",title:"In nghiêng"},"format_italic"),(0,i._)("span",{onClick:a[2]||(a[2]=t=>l.insert("> Quote")),class:"material-icons btn-icon",title:"Quote"},"format_quote"),(0,i._)("span",{onClick:a[3]||(a[3]=t=>l.insert("* List Item")),class:"material-icons btn-icon",title:"Generic List"},"format_list_bulleted"),(0,i._)("span",{onClick:a[4]||(a[4]=t=>l.insert("1. List Item")),class:"material-icons btn-icon",title:"Numbered List"},"format_list_numbered"),(0,i._)("span",{onClick:a[5]||(a[5]=t=>l.insert("[Alias](https://)")),class:"material-icons btn-icon",title:"Link"},"insert_link"),(0,i._)("span",{onClick:a[6]||(a[6]=t=>l.insert("![alt](https://)")),class:"material-icons btn-icon",title:"Image"},"insert_photo")]),(0,i.wy)((0,i._)("textarea",{rows:e.rows,placeholder:e.placeholder,"onUpdate:modelValue":a[7]||(a[7]=t=>l.value=t)},null,8,ti),[[s.nr,l.value]])])}var ei={name:"TextArea",props:{modelValue:{type:String},placeholder:{type:String},rows:{type:Number,default:30}},emits:["update:modelValue"],computed:{value:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}},methods:{insert(t){this.value=this.value+t}}};const si=(0,z.Z)(ei,[["render",ai],["__scopeId","data-v-285c7a72"]]);var ii=si;const ni=t=>((0,i.dD)("data-v-a9a97b28"),t=t(),(0,i.Cn)(),t),oi=ni((()=>(0,i._)("tr",null,[(0,i._)("th",null,"Sun"),(0,i._)("th",null,"Mon"),(0,i._)("th",null,"Tue"),(0,i._)("th",null,"Wed"),(0,i._)("th",null,"Thu"),(0,i._)("th",null,"Fri"),(0,i._)("th",null,"Sat")],-1))),li=["title","onClick"],ri=ni((()=>(0,i._)("hr",null,null,-1))),hi={class:"mb-4"},di={key:0},ci={key:1},ui=(0,i.Uk)(" Bạn không học gì vào ngày này "),gi=ni((()=>(0,i._)("br",null,null,-1))),pi=ni((()=>(0,i._)("br",null,null,-1))),mi=[ui,gi,pi],_i={class:"ml-3"},wi=(0,i.Uk)("Bắt đầu: "),yi=(0,i.Uk)("Kết thúc: "),vi=(0,i.Uk)("Đã học: "),Di=["innerHTML"],fi=ni((()=>(0,i._)("br",null,null,-1))),Ti=ni((()=>(0,i._)("hr",null,null,-1))),ki=ni((()=>(0,i._)("br",null,null,-1)));function bi(t,a,e,s,o,l){return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("table",null,[oi,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.diaries,((t,a)=>((0,i.wg)(),(0,i.iD)("tr",{key:a},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t,((t,e)=>((0,i.wg)(),(0,i.iD)("td",{key:e},[""!=t.day?((0,i.wg)(),(0,i.iD)("p",{key:0,title:"Ngày "+t.day,onClick:s=>l.setShowDay(a,e,t.day),style:(0,n.j5)({backgroundColor:l.dayBackground(t.diary.length)})},(0,n.zw)(t.day),13,li)):(0,i.kq)("",!0)])))),128))])))),128))]),ri,(0,i._)("div",null,[(0,i._)("h3",hi,(0,n.zw)(o.showDay.title),1),o.showDay.isInit?0==o.diaries[o.showDay.row][o.showDay.cols].diary.length?((0,i.wg)(),(0,i.iD)("div",ci,mi)):((0,i.wg)(!0),(0,i.iD)(i.HY,{key:2},(0,i.Ko)(o.diaries[o.showDay.row][o.showDay.cols].diary,((t,a)=>((0,i.wg)(),(0,i.iD)("div",{key:a},[(0,i._)("div",_i,[(0,i._)("p",null,[wi,(0,i._)("b",null,(0,n.zw)(new Date(t.start_at).toLocaleString("vi-VN")),1)]),(0,i._)("p",null,[yi,(0,i._)("b",null,(0,n.zw)(new Date(t.stop_at).toLocaleString("vi-VN")),1)]),(0,i._)("p",null,[vi,(0,i._)("b",null,(0,n.zw)(l.caculateTime(t.start_at,t.stop_at)),1)]),(0,i._)("p",{class:"quote",innerHTML:l.parseMarkdown(t.log)},null,8,Di)]),fi,Ti,ki])))),128)):((0,i.wg)(),(0,i.iD)("div",di," Hôm nay bạn chưa học gì "))])])}var Li=e(5068),Mi={name:"ContributionDiary",props:{propsDiaries:{type:Array,default:()=>[]},tag:{type:Number,required:!0},refeshToogle:{type:Boolean,default:!1}},created(){0!=this.propsDiaries.length?this.putDiary(this.propsDiaries):this.getDiaries()},data(){return{data:x.getAll(),diaries:[],showDay:{row:0,cols:0,isInit:!1,title:"Hôm nay",month:0,day:0,year:0},month:(new Date).getMonth()+1,year:(new Date).getFullYear()}},methods:{async getDiaries(){if(0==this.tag)throw new Error("tag is required");let t=await yt.get(`/study-diary/diary/${this.data.user.id}/${this.year}/${this.month}/${this.tag}`),a=await t.json();if(200!=t.status)throw new Error(a.error);a.data.length>0&&this.putDiary(a.data)},putDiary(t){let a=[[],[],[],[],[],[],[]],e=[[[],[0],[],[],[],[],[]],[[],[],[],[],[],[],[]],[[],[],[],[],[],[],[]],[[],[],[],[],[],[],[]],[[],[],[],[],[],[],[]],a],s=new Date(t[0].start_at),i=new Date(s.getFullYear(),s.getMonth(),1).getDay(),n=new Date(s.getFullYear(),s.getMonth()+1,0).getDate(),o=1;for(let l=0;l<e.length;l++)for(let t=0;t<e[l].length;t++){let a=o-i;e[l][t]=a>0&&a<=n?{day:a,diary:[]}:{day:"",diary:[]},o++}t.forEach((t=>{let a=new Date(t.start_at),s=a.getDate(),i=a.getDay(),n=new Date(a.getFullYear(),a.getMonth(),1).getDay(),o=Math.ceil((s+n)/7)-1;e[o][i].diary.push(t),a.toDateString()==(new Date).toDateString()&&(this.showDay.row=o,this.showDay.cols=i,this.showDay.isInit=!0)})),this.diaries=e},parseMarkdown(t){return Li.TU.parse(t)},caculateTime(t,a){let e=new Date(t),s=new Date(a),i=s.getTime()-e.getTime(),n=Math.round(i/6e4),o=(n/60).toFixed(2);return`${n} phút (${o} giờ)`},setShowDay(t,a,e){this.showDay.row=t,this.showDay.cols=a,this.showDay.day=e,this.showDay.title=`${e}/${this.month}/${this.year}`},dayBackground(t){switch(t){case 0:return"#ffffff";case 1:return"#ff907f30";case 2:return"#ff907f50";case 3:return"#ff907f70";case 4:return"#ff907f90";case 5:return"#ff907fa0";case 6:return"#ff907fc0";case 7:return"#ff907fe0";default:return"#ff907f"}}},watch:{refeshToogle:{handler(){this.getDiaries()},deep:!0}}};const Ci=(0,z.Z)(Mi,[["render",bi],["__scopeId","data-v-a9a97b28"]]);var Si=Ci,Ui={name:"SDTagView",created(){this.getTagData()},components:{MessagePopup:se,TextArea:ii,ContributionDiary:Si},data(){return{data:x.getAll(),tagData:{id:0,name:"",bg_color:"inherit",text_color:"inherit",icon:"",time_today:0,time_week:0,time_month:0,time_year:0,time_total:0},learningDiaryData:{id:0,sdtag:0,user:0,log:"",is_learning:0,start_at:"",stop_at:""},stopLearnPopup:{isDisplay:!1,log:"",preview:""},message:{title:"",message:"",type:"",isDisplay:!1},stopwatch:0,refeshToggle:!1}},methods:{async getTagData(){let t,a;this.data.isLoading=!0;try{if(t=await yt.get("/study-diary/tag/"+this.$route.params.id),a=await t.json(),200!=t.status)throw this.$router.push("/study-diary"),new Error(a.error)}catch(e){throw this.$router.push("/study-diary"),e}this.tagData=a.data,this.data.learningDiary.sdtag==this.tagData.id&&(this.learningDiaryData=this.data.learningDiary,this.startStopwatch()),this.data.isLoading=!1},startLearn(){this.data.learningDiary?this.showMessage("Lỗi","Bạn đang học môn khác rồi!","warning"):(this.data.isLoading=!0,yt.post("/study-diary/diary",{sdtag:this.tagData.id}).then((t=>{this.data.isLoading=!1,t.json().then((a=>{200===t.status?(this.learningDiaryData=a.data,this.data.learningDiary=this.learningDiaryData,sessionStorage.removeItem("tags"),this.startStopwatch()):(console.log(a.error),this.showMessage("Lỗi","Đã có lỗi xảy ra, vui lòng thử lại sau","error"))}))})).catch((t=>{console.log(t),this.data.isLoading=!1,this.showMessage("Lỗi","Không thể kết nối đến máy chủ, vui lòng thử lại sau","error")})))},async stopLearn(){if(0===this.stopLearnPopup.log.length)return void this.showMessage("Lỗi","Bạn chưa viết gì","warning");this.data.isLoading=!0;let t=await yt.put("/study-diary/diary",{id:this.learningDiaryData.id,log:this.stopLearnPopup.log}),a=await t.json();if(200!==t.status)throw this.showMessage("Lỗi","Đã có lỗi xảy ra, vui lòng thử lại sau","error"),new Error(a.error);this.learningDiaryData.is_learning=0,this.data.learningDiary=!1,this.stopLearnPopup.isDisplay=!1,this.stopLearnPopup.log="",this.tagData=a.data,sessionStorage.removeItem("tags"),this.refeshToggle=!this.refeshToggle,this.showMessage("Thành công","Lưu thành công","success"),this.data.isLoading=!1},minutesToStr(t){let a=(t/60).toFixed(2);return`${a} giờ (${t} phút)`},showMessage(t,a,e){this.message.title=t,this.message.message=a,this.message.type=e,this.message.isDisplay=!this.message.isDisplay},convertISOTimeToLocalDate(t){return new Date(t).toLocaleString("vi-VN",{timeZone:"Asia/Ho_Chi_Minh"})},startStopwatch(){let t=this.learningDiaryData.start_at,a=(new Date).toISOString(),e=new Date(a)-new Date(t),s=Math.round(e/1e3);this.stopwatch=s,this.loopStopwatch()},loopStopwatch(){this.learningDiaryData.is_learning&&setTimeout((()=>{this.stopwatch++,this.loopStopwatch()}),1e3)}},watch:{"stopLearnPopup.log"(t){this.stopLearnPopup.preview=Li.TU.parse(t)}},computed:{showStopwatchTime(){let t=Math.floor(this.stopwatch/60),a=this.stopwatch%60,e=(t/60).toFixed(2);return`${t} phút ${a} giây (${e} giờ)`}}};const xi=(0,z.Z)(Ui,[["render",Js],["__scopeId","data-v-495c6444"]]);var Pi=xi;const zi=[{path:"/",name:"home",component:at,meta:{title:"Trang Chủ - MTLKMS"}},{path:"/login",name:"login",component:ft,meta:{title:"Đăng Nhập - MTLKMS"}},{path:"/register",name:"register",component:Zt,meta:{title:"Đăng Ký - MTLKMS"}},{path:"/logout",name:"logout",component:ia,meta:{title:"Đăng Xuất - MTLKMS"}},{path:"/profile",name:"profile",component:ya,meta:{title:"Thông Tin Cá Nhân - MTLKMS"}},{path:"/profile/edit",name:"edit-profile",component:oe,meta:{title:"Chỉnh Sửa Thông Tin Cá Nhân - MTLKMS"}},{path:"/study-diary",name:"study-diary",component:vs,meta:{title:"Nhật Ký Thời Gian Học - MTLKMS"}},{path:"/study-diary/:id",name:"study-diary-tag",component:Pi,meta:{title:"Nhật Ký Thời Gian Học - MTLKMS"}}],ji=(0,Z.p7)({history:(0,Z.PO)("/"),routes:zi,scrollBehavior(t,a,e){return new Promise((t=>{setTimeout((()=>{t(e||{top:0})}),500)}))}});var Ai=ji;(0,s.ri)(R).use(Ai).mount("#app")}},a={};function e(s){var i=a[s];if(void 0!==i)return i.exports;var n=a[s]={exports:{}};return t[s](n,n.exports,e),n.exports}e.m=t,function(){var t=[];e.O=function(a,s,i,n){if(!s){var o=1/0;for(d=0;d<t.length;d++){s=t[d][0],i=t[d][1],n=t[d][2];for(var l=!0,r=0;r<s.length;r++)(!1&n||o>=n)&&Object.keys(e.O).every((function(t){return e.O[t](s[r])}))?s.splice(r--,1):(l=!1,n<o&&(o=n));if(l){t.splice(d--,1);var h=i();void 0!==h&&(a=h)}}return a}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[s,i,n]}}(),function(){e.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(a,{a:a}),a}}(),function(){e.d=function(t,a){for(var s in a)e.o(a,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:a[s]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)}}(),function(){var t={143:0};e.O.j=function(a){return 0===t[a]};var a=function(a,s){var i,n,o=s[0],l=s[1],r=s[2],h=0;if(o.some((function(a){return 0!==t[a]}))){for(i in l)e.o(l,i)&&(e.m[i]=l[i]);if(r)var d=r(e)}for(a&&a(s);h<o.length;h++)n=o[h],e.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return e.O(d)},s=self["webpackChunkmtlkms"]=self["webpackChunkmtlkms"]||[];s.forEach(a.bind(null,0)),s.push=a.bind(null,s.push.bind(s))}();var s=e.O(void 0,[998],(function(){return e(8743)}));s=e.O(s)})();
//# sourceMappingURL=app.bf5d199f.js.map